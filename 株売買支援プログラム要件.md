# 株売買支援プログラム 要求整理

## 目的
株売買ルール表に基づいて、売買判断を支援するプログラムを作成する。

## 要求事項
1. 株売買ルール表をもとに、買い時/売り時の株が分かること。
2. 個別株の詳細情報（価格推移、財務情報、ニュース等）にアクセスできること。
3. 各銘柄が買い時/売り時と判定された根拠（該当ルール、数値、判定理由）が確認できること。
4. 価格帯別（例: 1,000円未満、1,000〜3,000円、3,000円以上など）に銘柄を一覧表示できること。

## 出力イメージ
- 買い候補一覧
- 売り候補一覧
- 銘柄詳細画面（指標・ニュース・判定根拠）
- 価格帯フィルタ付き銘柄一覧

## 補足
価格帯の区分は固定値でも、ユーザーが任意設定できる方式でもよい。

## システム構成

### データ取得・保存方針
J-Quants APIの無料プランはレート制限（約10〜20リクエスト/分）が厳しく、ページ読み込みのたびにAPIを叩く設計では実用に耐えない。
そのため、**バッチ取得 + ローカルDB（SQLite）** 構成を採用する。

```
【データ更新フロー（1日1回）】
batch.py 実行 → J-Quants API → SQLite（local.db）に保存

【参照フロー（常時）】
ブラウザ → Webアプリ → SQLiteを読むだけ → 高速表示
```

### 対応銘柄数の目安
| 方式 | 銘柄数 | 備考 |
|---|---|---|
| バッチ + SQLite（手動実行） | 100〜500銘柄 | watchlist.txtで管理 |
| バッチ + SQLite（タスクスケジューラ自動実行） | 全上場銘柄（4,000+） | 将来拡張 |

### バッチ実行タイミング
- 原則として引け後（15:30以降）に手動または自動で実行する。
- J-Quantsの日次データ更新完了後にバッチを動かすこと（`株売買ルール表.md` の実装ルールに準拠）。

### Webアプリの動作
- 起動時・ページ読み込み時はSQLiteのみを参照し、J-Quants APIへのリアルタイムアクセスは行わない。
- バッチ未実行時はデータなし旨をUI上に表示する。
